<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ZWV Fahrplan Landshut</title>
  <!-- Firebase SDK hinzufügen -->
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database.js"></script>
  
  <style>
    /* Dein bestehendes CSS */
  </style>
</head>
<body>
  <!-- Deine HTML-Inhalte -->
  <div class="header">
    <h1>ZWV Fahrplan Landshut</h1>
    <p>Aktuelle Uhrzeit: <span id="clock"></span></p>
  </div>

  <div class="table-container">
    <table id="flight-table">
      <thead>
        <tr>
          <th>Zeit</th>
          <th>Ziel</th>
          <th>ZWV</th>
          <th>Status</th>
          <th>Aktionen</th>
        </tr>
      </thead>
      <tbody>
        <!-- Die Zeilen werden hier per JavaScript hinzugefügt -->
      </tbody>
    </table>
  </div>

  <script>
    // Firebase konfigurieren und initialisieren
    const firebaseConfig = {
      apiKey: "AIzaSyAvlfn-jHIZwhw-AFMKbq9z_dt4FoUshv0",
      authDomain: "dulcet-genius-159810.firebaseapp.com",
      projectId: "dulcet-genius-159810",
      storageBucket: "dulcet-genius-159810.appspot.com",
      messagingSenderId: "497292603839",
      appId: "1:497292603839:web:364fd605108fd25e1a710a",
      measurementId: "G-79QZD0YHGC"
    };

    // Firebase initialisieren
    const app = firebase.initializeApp(firebaseConfig);
    const database = firebase.database();

      const flights = [
    { time: "00:15", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV430" },
    { time: "05:45", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV430" },
    { time: "12:15", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV430" },
    { time: "17:45", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV430" },
    { time: "02:15", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV432" },
    { time: "07:45", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV432" },
    { time: "14:15", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV432" },
    { time: "19:45", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV432" },
    { time: "03:15", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV433" },
    { time: "08:45", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV433" },
    { time: "15:15", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV433" },
    { time: "20:45", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV433" },
    { time: "04:15", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV434" },
    { time: "09:45", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV434" },
    { time: "16:15", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV434" },
    { time: "21:45", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV434" },
    { time: "05:30", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV435" },
    { time: "11:00", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV435" },
    { time: "17:30", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV435" },
    { time: "23:00", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV435" },
    { time: "01:45", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV436" },
    { time: "07:15", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV436" },
    { time: "12:45", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV436" },
    { time: "18:15", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV436" },
    { time: "04:15", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV437" },
    { time: "09:45", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV437" },
    { time: "15:15", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV437" },
    { time: "20:45", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV437" },
    { time: "06:15", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV438" },
    { time: "11:45", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV438" },
    { time: "17:15", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV438" },
    { time: "22:45", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV438" },
    { time: "04:00", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV439" },
    { time: "09:30", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV439" },
    { time: "15:00", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV439" },
    { time: "20:30", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV439" },
    { time: "00:15", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV440" },
    { time: "06:15", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV440" },
    { time: "12:45", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV440" },
    { time: "19:15", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV440" },
    { time: "02:15", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV442" },
    { time: "07:45", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV442" },
    { time: "14:15", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV442" },
    { time: "19:45", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV442" },
    { time: "01:15", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV444" },
    { time: "06:45", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV444" },
    { time: "12:15", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV444" },
    { time: "17:45", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV444" },
    { time: "02:15", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV447" },
    { time: "07:45", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV447" },
    { time: "14:15", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV447" },
    { time: "19:45", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV447" },
    { time: "02:15", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV448" },
    { time: "07:45", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV448" },
    { time: "14:15", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV448" },
    { time: "19:45", destination: "Anmeldung Wareneingang Werk 4.1", flight: "ZWV448" }
  ];

    let rowStatus = Array(flights.length).fill("");
    
    // Echtzeit-Daten empfangen und Tabelle aktualisieren
    database.ref('flights').on('value', function(snapshot) {
      snapshot.forEach(function(childSnapshot) {
        var data = childSnapshot.val();
        rowStatus[childSnapshot.key] = data.color;
      });
      updateFlights();
    });

    // Funktion zum Markieren einer Zeile als erledigt/nicht erledigt
    function markAsDone(index, color) {
      rowStatus[index] = color;
      updateFlights();
      database.ref('flights/' + index).set({ color: color });
    }

    // Funktion zur Aktualisierung der Fluganzeige
    function updateFlights() {
      const tableBody = document.querySelector('#flight-table tbody');
      tableBody.innerHTML = '';

      flights.forEach((flight, index) => {
        const row = document.createElement('tr');
        let rowClass = rowStatus[index] === 'green' ? 'green-row' : rowStatus[index] === 'red' ? 'red-row' : '';
        
        row.innerHTML = `
          <td class="${rowClass}">${flight.time}</td>
          <td class="${rowClass}">${flight.destination}</td>
          <td class="${rowClass}">${flight.flight}</td>
          <td class="${rowClass}">${rowStatus[index]}</td>
          <td class="${rowClass}">
            <button onclick="markAsDone(${index}, 'green')">Erledigt</button>
            <button onclick="markAsDone(${index}, 'red')">Nicht erledigt</button>
          </td>
        `;
        tableBody.appendChild(row);
      });
    }

    updateFlights();
  </script>
</body>
</html>
